apiVersion: kustomize.config.k8s.io/v1beta1
commonLabels:
  argocd.argoproj.io/instance: seed-job
kind: Kustomization
namespace: argocd

generatorOptions:
  disableNameSuffixHash: true

patches:
  - path: ../deployment-patch.yaml
    target:
      group: argoproj.io
      kind: Application
      name: .*
      version: v1alpha1

  - path: deployment-replace-patch.yaml
    target:
      group: argoproj.io
      kind: Application
      name: monitoring-crds
      version: v1alpha1

#patchesJSON6902:
#  - patch: |-
#      - op: replace
#        path: /metadata/annotations
#        value: {}
#      - op: add
#        path: /metadata/annotations/argocd.argoproj.io~1hook
#        value: PostSync
#      - op: add
#        path: /metadata/annotations/argocd.argoproj.io~1sync-wave
#        value: "-1"
#    target:
#      group: ""
#      kind: ConfigMap
#      name: bootstrap-state
#      version: v1

#patchesJSON6902:
#- target:
#      group: argoproj.io
#      kind: Application
#      version: v1alpha1
#      name: argocd
#  patch: |-
#    - op: add
#      path: /spec/source/helm/valueFiles
#      value:
#        - values-kind-deployments.yaml

resources:
  #- workflow-update-seed.yaml
  - ../../../src/applications/argo-cd/deploy/argocd
  - ../../../src/applications/monitoring/deploy/argocd
  #- ../../../src/applications/argo-workflow-templates/deploy/argocd
  #- ../../../src/applications/argo-workflows/deploy/argocd
  - ../../../src/applications/argo-events/deploy/argocd  